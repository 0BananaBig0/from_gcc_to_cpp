#################################################################
#											 Makefile
#		Makefile to build exe
#################################################################
.PHONY: clean, all
# Define the compiler variable
CC = g++

# List all .cpp files, .o files, .a files and .so files
SRCS = Main.cpp Fun.cpp FunN.cpp
# OBJS = Main.o Fun.o FunN.o
OBJS = Main.o
STATIC_LIBS = libFun.a
SHARED_LIBS = libFunN.so
TARGET = Main.exe

# Generate a list of .d files from SRCS
DEPS = $(SRCS:.cpp=.d)

# Default target:
# $(TARGET): $(OBJS)
#		$(CC) -o $@ $^
$(TARGET): $(OBJS) $(STATIC_LIBS) $(SHARED_LIBS)
	$(CC) -o $@ $< -L. -lFun -lFunN

# The rule for # *.d is generated by *.cpp:
%.d: %.cpp
	$(CC) -MM $< > $@

# Pattern rules:
%.o: %.cpp
	$(CC) -c -fPIC -o $@ $<

# Rule to create the static library from Fun.cpp
$(STATIC_LIBS): lib%.a: %.o
	ar rcs $@ $<

# Rule to create the shared library from Fun.cpp
$(SHARED_LIBS): lib%.so: %.o
	$(CC) -shared -o $@ $<

clean:
	@echo "Cleaning up ......"
	@-rm -rf *.exe *.o *.i *.s *.a *.so *.d # - prefix for ignoring errors

# Include all .d files: inform make to generate all .d files
include $(DEPS)


